@echo off
chcp 65001 >nul
setlocal enabledelayedexpansion

echo.
echo ðŸš€ æœˆå ±ä½œæˆæ”¯æ´ãƒ„ãƒ¼ãƒ« - Windowsç‰ˆèµ·å‹•ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
echo ================================================
echo.

:: Pythonç’°å¢ƒãƒã‚§ãƒƒã‚¯
echo ðŸ Pythonç’°å¢ƒã‚’ãƒã‚§ãƒƒã‚¯ä¸­...
python --version >nul 2>&1
if !errorlevel! neq 0 (
    echo âŒ PythonãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã¾ã›ã‚“
    echo.
    echo ðŸ“¥ Pythonã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ãã ã•ã„ï¼š
    echo    1. https://www.python.org/downloads/ ã‚’é–‹ã
    echo    2. ã€ŒDownload Pythonã€é»„è‰²ã„ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
    echo    3. ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ãƒ–ãƒ«ã‚¯ãƒªãƒƒã‚¯
    echo    4. âš ï¸ é‡è¦ï¼šã€ŒAdd Python to PATHã€ã«ãƒã‚§ãƒƒã‚¯ã‚’å…¥ã‚Œã‚‹
    echo    5. ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å®Œäº†å¾Œã€ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚‚ã†ä¸€åº¦ãƒ€ãƒ–ãƒ«ã‚¯ãƒªãƒƒã‚¯
    echo.
    pause
    exit /b 1
)

:: Node.jsç’°å¢ƒãƒã‚§ãƒƒã‚¯
echo ðŸŸ¢ PythonãŒè¦‹ã¤ã‹ã‚Šã¾ã—ãŸ
echo ðŸ“± Node.jsç’°å¢ƒã‚’ãƒã‚§ãƒƒã‚¯ä¸­...
node --version >nul 2>&1
if !errorlevel! neq 0 (
    echo âŒ Node.jsãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã¾ã›ã‚“
    echo.
    echo ðŸ“¥ Node.jsã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ãã ã•ã„ï¼š
    echo    1. https://nodejs.org/ ã‚’é–‹ã
    echo    2. å·¦ã®ã€ŒLTSã€ç‰ˆï¼ˆæŽ¨å¥¨ç‰ˆï¼‰ã‚’ã‚¯ãƒªãƒƒã‚¯
    echo    3. ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ãƒ–ãƒ«ã‚¯ãƒªãƒƒã‚¯
    echo    4. ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å®Œäº†å¾Œã€ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚‚ã†ä¸€åº¦ãƒ€ãƒ–ãƒ«ã‚¯ãƒªãƒƒã‚¯
    echo.
    pause
    exit /b 1
)

echo ðŸŸ¢ Node.jsãŒè¦‹ã¤ã‹ã‚Šã¾ã—ãŸ
echo.

:: ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰èµ·å‹•
echo ðŸ ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚’èµ·å‹•ä¸­...
cd /d "%~dp0backend"

:: ä»®æƒ³ç’°å¢ƒã®ä½œæˆãƒ»ã‚¢ã‚¯ãƒ†ã‚£ãƒ™ãƒ¼ãƒˆ
if not exist "venv" (
    echo ðŸ“¦ Pythonä»®æƒ³ç’°å¢ƒã‚’ä½œæˆä¸­...
    python -m venv venv
)

call venv\Scripts\activate.bat

:: ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
echo ðŸ“¦ å¿…è¦ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ä¸­...
pip install -r requirements.txt >nul 2>&1

:: ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰èµ·å‹•
echo ðŸŸ¢ ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚µãƒ¼ãƒãƒ¼ã‚’èµ·å‹•ä¸­...
start "" python main.py

cd /d "%~dp0"

:: å°‘ã—å¾…æ©Ÿ
echo â³ 3ç§’å¾…æ©Ÿä¸­...
timeout /t 3 /nobreak >nul

:: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰èµ·å‹•
echo ðŸ“± ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚’èµ·å‹•ä¸­...
cd /d "%~dp0frontend"

:: npm installï¼ˆåˆå›žã®ã¿ï¼‰
if not exist "node_modules" (
    echo ðŸ“¦ ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ä¾å­˜é–¢ä¿‚ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ä¸­...
    npm install
)

echo ðŸŸ¢ ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚µãƒ¼ãƒãƒ¼ã‚’èµ·å‹•ä¸­...
start "" npm start

cd /d "%~dp0"

echo.
echo âœ… èµ·å‹•å®Œäº†ï¼
echo ================================================
echo ðŸŒ ãƒ–ãƒ©ã‚¦ã‚¶ãŒè‡ªå‹•ã§é–‹ãã¾ã§å°‘ã—ãŠå¾…ã¡ãã ã•ã„...
echo ðŸ“± ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰: http://localhost:3456
echo ðŸ”§ ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰: http://localhost:8000
echo.
echo ðŸ’¡ ã‚¢ãƒ—ãƒªã‚’åœæ­¢ã—ãŸã„å ´åˆï¼š
echo    é»’ã„ç”»é¢ï¼ˆã‚³ãƒžãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆï¼‰ã‚’é–‰ã˜ã¦ãã ã•ã„
echo.
echo ðŸŽ‰ æœˆå ±ä½œæˆã‚’æ¥½ã—ã‚“ã§ãã ã•ã„ï¼
echo ================================================

:: ãƒ–ãƒ©ã‚¦ã‚¶ã‚’é–‹ãï¼ˆå°‘ã—é…å»¶ã•ã›ã‚‹ï¼‰
timeout /t 10 /nobreak >nul
start "" "http://localhost:3456"

pause