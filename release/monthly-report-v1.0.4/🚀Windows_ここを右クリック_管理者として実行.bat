@echo off
chcp 65001 >nul
setlocal enabledelayedexpansion
color 0B
cls

echo â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
echo â•‘    ğŸš€ æœˆå ±ä½œæˆæ”¯æ´ãƒ„ãƒ¼ãƒ« v1.0.4       â•‘
echo â•‘                                        â•‘
echo â•‘    èµ·å‹•æº–å‚™ã‚’é–‹å§‹ã—ã¾ã™...             â•‘
echo â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.

:: ç®¡ç†è€…æ¨©é™ãƒã‚§ãƒƒã‚¯
net session >nul 2>&1
if !errorlevel! neq 0 (
    color 0C
    echo.
    echo âŒ ç®¡ç†è€…æ¨©é™ãŒå¿…è¦ã§ã™
    echo.
    echo ğŸ”§ æ­£ã—ã„èµ·å‹•æ–¹æ³•ï¼š
    echo.
    echo   1. ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å³ã‚¯ãƒªãƒƒã‚¯
    echo   2. ã€Œç®¡ç†è€…ã¨ã—ã¦å®Ÿè¡Œã€ã‚’é¸æŠ
    echo.
    echo â€»ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¢ã‚«ã‚¦ãƒ³ãƒˆåˆ¶å¾¡ãŒè¡¨ç¤ºã•ã‚ŒãŸã‚‰ã€Œã¯ã„ã€ã‚’ã‚¯ãƒªãƒƒã‚¯
    echo.
    pause
    exit /b 1
)

:: Dockerãƒã‚§ãƒƒã‚¯
echo ğŸ³ Docker Desktopã‚’ç¢ºèªä¸­...
docker --version >nul 2>&1
if !errorlevel! neq 0 (
    color 0C
    echo.
    echo âŒ Docker DesktopãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã¾ã›ã‚“
    echo.
    echo ğŸ“¥ ã‹ã‚“ãŸã‚“ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ–¹æ³•ï¼š
    echo.
    echo   1. ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯ã‚’ãƒ–ãƒ©ã‚¦ã‚¶ã§é–‹ãï¼š
    echo      https://www.docker.com/products/docker-desktop/
    echo.
    echo   2. ã€ŒDownload for Windowsã€ã‚’ã‚¯ãƒªãƒƒã‚¯
    echo.
    echo   3. ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ãƒ–ãƒ«ã‚¯ãƒªãƒƒã‚¯
    echo.
    echo   4. ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å®Œäº†å¾Œã€PCã‚’å†èµ·å‹•
    echo.
    echo   5. Docker Desktopã‚’èµ·å‹•ï¼ˆãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ã®ã‚¢ã‚¤ã‚³ãƒ³ï¼‰
    echo.
    echo   6. ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚‚ã†ä¸€åº¦å®Ÿè¡Œ
    echo.
    echo è©³ã—ãã¯ docs ãƒ•ã‚©ãƒ«ãƒ€ã®èª¬æ˜æ›¸ã‚’ã”è¦§ãã ã•ã„
    echo.
    pause
    exit /b 1
)

docker info >nul 2>&1
if !errorlevel! neq 0 (
    color 0E
    echo.
    echo âš ï¸  Docker DesktopãŒèµ·å‹•ã—ã¦ã„ã¾ã›ã‚“
    echo.
    echo ğŸ³ èµ·å‹•æ–¹æ³•ï¼š
    echo.
    echo   1. ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ã® Docker Desktop ã‚¢ã‚¤ã‚³ãƒ³ã‚’ãƒ€ãƒ–ãƒ«ã‚¯ãƒªãƒƒã‚¯
    echo      ï¼ˆã¾ãŸã¯ï¼‰
    echo      ã‚¹ã‚¿ãƒ¼ãƒˆãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‹ã‚‰ã€ŒDocker Desktopã€ã‚’æ¤œç´¢ã—ã¦èµ·å‹•
    echo.
    echo   2. ã‚¿ã‚¹ã‚¯ãƒãƒ¼ã«ã‚¯ã‚¸ãƒ©ã®ã‚¢ã‚¤ã‚³ãƒ³ğŸ³ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã¾ã§å¾…ã¤ï¼ˆç´„1åˆ†ï¼‰
    echo.
    echo   3. ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚‚ã†ä¸€åº¦å®Ÿè¡Œ
    echo.
    pause
    exit /b 1
)

color 0A
echo âœ… Docker Desktop ç¢ºèªOK
echo.

:: èµ·å‹•ç¢ºèª
echo â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
echo ğŸ¯ æœˆå ±ä½œæˆãƒ„ãƒ¼ãƒ«ã‚’èµ·å‹•ã—ã¾ã™
echo â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
echo.
echo æº–å‚™ãŒã§ããŸã‚‰ Enter ã‚­ãƒ¼ã‚’æŠ¼ã—ã¦ãã ã•ã„
echo ï¼ˆã‚­ãƒ£ãƒ³ã‚»ãƒ«ã™ã‚‹å ´åˆã¯ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’é–‰ã˜ã‚‹ï¼‰
pause >nul

:: ãƒ¡ã‚¤ãƒ³ã®èµ·å‹•ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œ
echo.
echo ğŸš€ èµ·å‹•ä¸­...
if exist "app\manual-start.bat" (
    cd app
    call manual-start.bat
) else if exist "manual-start.bat" (
    call manual-start.bat
) else (
    color 0C
    echo.
    echo âŒ ã‚¨ãƒ©ãƒ¼: èµ·å‹•ãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“
    echo ZIPãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ­£ã—ãè§£å‡ã—ãŸã‹ç¢ºèªã—ã¦ãã ã•ã„
    echo.
    pause
    exit /b 1
)